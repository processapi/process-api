var Deno=globalThis.Deno??(typeof global>"u"?void 0:{readFile:(await import("node:fs")).readFileSync}),module=await(async()=>{let crypto=globalThis.crypto??await import("node:crypto");return{require:string=>{if(string!=="crypto")throw new Error("Unexpected require "+string);return crypto}}})(),heap=new Array(128).fill(void 0);heap.push(void 0,null,!0,!1);function getObject(idx){return heap[idx]}var cachedTextDecoder=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&cachedTextDecoder.decode();var cachedUint8ArrayMemory0=null;function getUint8ArrayMemory0(){return(cachedUint8ArrayMemory0===null||cachedUint8ArrayMemory0.byteLength===0)&&(cachedUint8ArrayMemory0=new Uint8Array(wasm.memory.buffer)),cachedUint8ArrayMemory0}function getStringFromWasm0(ptr,len){return ptr=ptr>>>0,cachedTextDecoder.decode(getUint8ArrayMemory0().subarray(ptr,ptr+len))}var heap_next=heap.length;function addHeapObject(obj){heap_next===heap.length&&heap.push(heap.length+1);let idx=heap_next;return heap_next=heap[idx],heap[idx]=obj,idx}function dropObject(idx){idx<132||(heap[idx]=heap_next,heap_next=idx)}function takeObject(idx){let ret=getObject(idx);return dropObject(idx),ret}function isLikeNone(x){return x==null}var cachedDataViewMemory0=null;function getDataViewMemory0(){return(cachedDataViewMemory0===null||cachedDataViewMemory0.buffer.detached===!0||cachedDataViewMemory0.buffer.detached===void 0&&cachedDataViewMemory0.buffer!==wasm.memory.buffer)&&(cachedDataViewMemory0=new DataView(wasm.memory.buffer)),cachedDataViewMemory0}var WASM_VECTOR_LEN=0,cachedTextEncoder=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},encodeString=function(arg,view){return cachedTextEncoder.encodeInto(arg,view)};function passStringToWasm0(arg,malloc,realloc){if(realloc===void 0){let buf=cachedTextEncoder.encode(arg),ptr2=malloc(buf.length,1)>>>0;return getUint8ArrayMemory0().subarray(ptr2,ptr2+buf.length).set(buf),WASM_VECTOR_LEN=buf.length,ptr2}let len=arg.length,ptr=malloc(len,1)>>>0,mem=getUint8ArrayMemory0(),offset=0;for(;offset<len;offset++){let code=arg.charCodeAt(offset);if(code>127)break;mem[ptr+offset]=code}if(offset!==len){offset!==0&&(arg=arg.slice(offset)),ptr=realloc(ptr,len,len=offset+arg.length*3,1)>>>0;let view=getUint8ArrayMemory0().subarray(ptr+offset,ptr+len),ret=encodeString(arg,view);offset+=ret.written,ptr=realloc(ptr,len,offset,1)>>>0}return WASM_VECTOR_LEN=offset,ptr}function debugString(val){let type=typeof val;if(type=="number"||type=="boolean"||val==null)return`${val}`;if(type=="string")return`"${val}"`;if(type=="symbol"){let description=val.description;return description==null?"Symbol":`Symbol(${description})`}if(type=="function"){let name=val.name;return typeof name=="string"&&name.length>0?`Function(${name})`:"Function"}if(Array.isArray(val)){let length=val.length,debug="[";length>0&&(debug+=debugString(val[0]));for(let i=1;i<length;i++)debug+=", "+debugString(val[i]);return debug+="]",debug}let builtInMatches=/\[object ([^\]]+)\]/.exec(toString.call(val)),className;if(builtInMatches.length>1)className=builtInMatches[1];else return toString.call(val);if(className=="Object")try{return"Object("+JSON.stringify(val)+")"}catch{return"Object"}return val instanceof Error?`${val.name}: ${val.message}
${val.stack}`:className}var CLOSURE_DTORS=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(state=>{wasm.__wbindgen_export_2.get(state.dtor)(state.a,state.b)});function makeMutClosure(arg0,arg1,dtor,f){let state={a:arg0,b:arg1,cnt:1,dtor},real=(...args)=>{state.cnt++;let a=state.a;state.a=0;try{return f(a,state.b,...args)}finally{--state.cnt===0?(wasm.__wbindgen_export_2.get(state.dtor)(a,state.b),CLOSURE_DTORS.unregister(state)):state.a=a}};return real.original=state,CLOSURE_DTORS.register(real,state,state),real}function __wbg_adapter_52(arg0,arg1,arg2){try{let retptr=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.__wbindgen_export_3(retptr,arg0,arg1,addHeapObject(arg2));var r0=getDataViewMemory0().getInt32(retptr+4*0,!0),r1=getDataViewMemory0().getInt32(retptr+4*1,!0);if(r1)throw takeObject(r0)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}function __wbg_adapter_55(arg0,arg1){wasm.__wbindgen_export_4(arg0,arg1)}function __wbg_adapter_58(arg0,arg1,arg2){wasm.__wbindgen_export_5(arg0,arg1,addHeapObject(arg2))}function handleError(f,args){try{return f.apply(this,args)}catch(e){wasm.__wbindgen_export_7(addHeapObject(e))}}function __wbg_adapter_327(arg0,arg1,arg2,arg3){wasm.__wbindgen_export_8(arg0,arg1,addHeapObject(arg2),addHeapObject(arg3))}var IntoUnderlyingByteSourceFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(ptr=>wasm.__wbg_intounderlyingbytesource_free(ptr>>>0,1));var IntoUnderlyingSinkFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(ptr=>wasm.__wbg_intounderlyingsink_free(ptr>>>0,1));var IntoUnderlyingSourceFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(ptr=>wasm.__wbg_intounderlyingsource_free(ptr>>>0,1)),IntoUnderlyingSource=class{static __wrap(ptr){ptr=ptr>>>0;let obj=Object.create(IntoUnderlyingSource.prototype);return obj.__wbg_ptr=ptr,IntoUnderlyingSourceFinalization.register(obj,obj.__wbg_ptr,obj),obj}__destroy_into_raw(){let ptr=this.__wbg_ptr;return this.__wbg_ptr=0,IntoUnderlyingSourceFinalization.unregister(this),ptr}free(){let ptr=this.__destroy_into_raw();wasm.__wbg_intounderlyingsource_free(ptr,0)}pull(controller){let ret=wasm.intounderlyingsource_pull(this.__wbg_ptr,addHeapObject(controller));return takeObject(ret)}cancel(){let ptr=this.__destroy_into_raw();wasm.intounderlyingsource_cancel(ptr)}},SurrealWasmEngineFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(ptr=>wasm.__wbg_surrealwasmengine_free(ptr>>>0,1)),SurrealWasmEngine=class{static __wrap(ptr){ptr=ptr>>>0;let obj=Object.create(SurrealWasmEngine.prototype);return obj.__wbg_ptr=ptr,SurrealWasmEngineFinalization.register(obj,obj.__wbg_ptr,obj),obj}__destroy_into_raw(){let ptr=this.__wbg_ptr;return this.__wbg_ptr=0,SurrealWasmEngineFinalization.unregister(this),ptr}free(){let ptr=this.__destroy_into_raw();wasm.__wbg_surrealwasmengine_free(ptr,0)}execute(data){let ret=wasm.surrealwasmengine_execute(this.__wbg_ptr,addHeapObject(data));return takeObject(ret)}notifications(){try{let retptr=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.surrealwasmengine_notifications(retptr,this.__wbg_ptr);var r0=getDataViewMemory0().getInt32(retptr+4*0,!0),r1=getDataViewMemory0().getInt32(retptr+4*1,!0),r2=getDataViewMemory0().getInt32(retptr+4*2,!0);if(r2)throw takeObject(r1);return takeObject(r0)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}static connect(endpoint,opts){let ptr0=passStringToWasm0(endpoint,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len0=WASM_VECTOR_LEN,ret=wasm.surrealwasmengine_connect(ptr0,len0,isLikeNone(opts)?0:addHeapObject(opts));return takeObject(ret)}static version(){let deferred2_0,deferred2_1;try{let retptr=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.surrealwasmengine_version(retptr);var r0=getDataViewMemory0().getInt32(retptr+4*0,!0),r1=getDataViewMemory0().getInt32(retptr+4*1,!0),r2=getDataViewMemory0().getInt32(retptr+4*2,!0),r3=getDataViewMemory0().getInt32(retptr+4*3,!0),ptr1=r0,len1=r1;if(r3)throw ptr1=0,len1=0,takeObject(r2);return deferred2_0=ptr1,deferred2_1=len1,getStringFromWasm0(ptr1,len1)}finally{wasm.__wbindgen_add_to_stack_pointer(16),wasm.__wbindgen_export_6(deferred2_0,deferred2_1,1)}}},imports={__wbindgen_placeholder__:{__wbindgen_is_undefined:function(arg0){return getObject(arg0)===void 0},__wbindgen_in:function(arg0,arg1){return getObject(arg0)in getObject(arg1)},__wbindgen_boolean_get:function(arg0){let v=getObject(arg0);return typeof v=="boolean"?v?1:0:2},__wbindgen_is_object:function(arg0){let val=getObject(arg0);return typeof val=="object"&&val!==null},__wbindgen_error_new:function(arg0,arg1){let ret=new Error(getStringFromWasm0(arg0,arg1));return addHeapObject(ret)},__wbindgen_jsval_eq:function(arg0,arg1){return getObject(arg0)===getObject(arg1)},__wbindgen_object_drop_ref:function(arg0){takeObject(arg0)},__wbindgen_string_new:function(arg0,arg1){let ret=getStringFromWasm0(arg0,arg1);return addHeapObject(ret)},__wbindgen_is_bigint:function(arg0){return typeof getObject(arg0)=="bigint"},__wbindgen_number_get:function(arg0,arg1){let obj=getObject(arg1),ret=typeof obj=="number"?obj:void 0;getDataViewMemory0().setFloat64(arg0+8*1,isLikeNone(ret)?0:ret,!0),getDataViewMemory0().setInt32(arg0+4*0,!isLikeNone(ret),!0)},__wbindgen_bigint_from_i64:function(arg0){return addHeapObject(arg0)},__wbindgen_string_get:function(arg0,arg1){let obj=getObject(arg1),ret=typeof obj=="string"?obj:void 0;var ptr1=isLikeNone(ret)?0:passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbindgen_bigint_from_u64:function(arg0){let ret=BigInt.asUintN(64,arg0);return addHeapObject(ret)},__wbg_surrealwasmengine_new:function(arg0){let ret=SurrealWasmEngine.__wrap(arg0);return addHeapObject(ret)},__wbindgen_object_clone_ref:function(arg0){let ret=getObject(arg0);return addHeapObject(ret)},__wbindgen_jsval_loose_eq:function(arg0,arg1){return getObject(arg0)==getObject(arg1)},__wbindgen_as_number:function(arg0){return+getObject(arg0)},__wbg_String_b9412f8799faab3e:function(arg0,arg1){let ret=String(getObject(arg1)),ptr1=passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbindgen_number_new:function(arg0){return addHeapObject(arg0)},__wbg_getwithrefkey_edc2c8960f0f1191:function(arg0,arg1){let ret=getObject(arg0)[getObject(arg1)];return addHeapObject(ret)},__wbindgen_cb_drop:function(arg0){let obj=takeObject(arg0).original;return obj.cnt--==1?(obj.a=0,!0):!1},__wbindgen_is_falsy:function(arg0){return!getObject(arg0)},__wbg_new_abda76e883ba8a5f:function(){let ret=new Error;return addHeapObject(ret)},__wbg_stack_658279fe44541cf6:function(arg0,arg1){let ret=getObject(arg1).stack,ptr1=passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbg_error_f851667af71bcfc6:function(arg0,arg1){let deferred0_0,deferred0_1;try{deferred0_0=arg0,deferred0_1=arg1,console.error(getStringFromWasm0(arg0,arg1))}finally{wasm.__wbindgen_export_6(deferred0_0,deferred0_1,1)}},__wbg_performance_1430613edb72ce03:function(arg0){let ret=getObject(arg0).performance;return addHeapObject(ret)},__wbg_now_eab901b1d3b8a295:function(arg0){return getObject(arg0).now()},__wbg_setTimeout_fba1b48a90e30862:function(){return handleError(function(arg0,arg1,arg2){return getObject(arg0).setTimeout(getObject(arg1),arg2)},arguments)},__wbg_fetch_25e3a297f7b04639:function(arg0){let ret=fetch(getObject(arg0));return addHeapObject(ret)},__wbg_sethighWaterMark_ea50ed3ec2143088:function(arg0,arg1){getObject(arg0).highWaterMark=arg1},__wbg_newwithintounderlyingsource_a03a82aa1bbbb292:function(arg0,arg1){let ret=new ReadableStream(IntoUnderlyingSource.__wrap(arg0),takeObject(arg1));return addHeapObject(ret)},__wbg_queueMicrotask_48421b3cc9052b68:function(arg0){let ret=getObject(arg0).queueMicrotask;return addHeapObject(ret)},__wbindgen_is_function:function(arg0){return typeof getObject(arg0)=="function"},__wbg_queueMicrotask_12a30234db4045d3:function(arg0){queueMicrotask(getObject(arg0))},__wbg_signal_41e46ccad44bb5e2:function(arg0){let ret=getObject(arg0).signal;return addHeapObject(ret)},__wbg_new_ebf2727385ee825c:function(){return handleError(function(){let ret=new AbortController;return addHeapObject(ret)},arguments)},__wbg_abort_8659d889a7877ae3:function(arg0){getObject(arg0).abort()},__wbg_newwithu8arraysequenceandoptions_c8bc456a23f02fca:function(){return handleError(function(arg0,arg1){let ret=new Blob(getObject(arg0),getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_settype_b6ab7b74bd1908a1:function(arg0,arg1,arg2){getObject(arg0).type=getStringFromWasm0(arg1,arg2)},__wbg_length_82021578cc4f0d2c:function(arg0){return getObject(arg0).length},__wbg_contains_a3146787308ac83e:function(arg0,arg1,arg2){return getObject(arg0).contains(getStringFromWasm0(arg1,arg2))},__wbg_get_913f8df8566b2d82:function(arg0,arg1,arg2){let ret=getObject(arg1)[arg2>>>0];var ptr1=isLikeNone(ret)?0:passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbg_target_b7cb1739bee70928:function(arg0){let ret=getObject(arg0).target;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_new_f9f1d655d855a601:function(){return handleError(function(){let ret=new FormData;return addHeapObject(ret)},arguments)},__wbg_append_876bddfd2c8b42fb:function(){return handleError(function(arg0,arg1,arg2,arg3){getObject(arg0).append(getStringFromWasm0(arg1,arg2),getObject(arg3))},arguments)},__wbg_append_fc486ec9757bf1c1:function(){return handleError(function(arg0,arg1,arg2,arg3,arg4,arg5){getObject(arg0).append(getStringFromWasm0(arg1,arg2),getObject(arg3),getStringFromWasm0(arg4,arg5))},arguments)},__wbg_append_b10805b72af15312:function(){return handleError(function(arg0,arg1,arg2,arg3,arg4){getObject(arg0).append(getStringFromWasm0(arg1,arg2),getStringFromWasm0(arg3,arg4))},arguments)},__wbg_new_e27c93803e1acc42:function(){return handleError(function(){let ret=new Headers;return addHeapObject(ret)},arguments)},__wbg_append_f3a4426bb50622c5:function(){return handleError(function(arg0,arg1,arg2,arg3,arg4){getObject(arg0).append(getStringFromWasm0(arg1,arg2),getStringFromWasm0(arg3,arg4))},arguments)},__wbg_key_37c613728ba0b769:function(){return handleError(function(arg0){let ret=getObject(arg0).key;return addHeapObject(ret)},arguments)},__wbg_advance_0922866a23942467:function(){return handleError(function(arg0,arg1){getObject(arg0).advance(arg1>>>0)},arguments)},__wbg_continue_a92b4c9f17458897:function(){return handleError(function(arg0){getObject(arg0).continue()},arguments)},__wbg_value_d4be628e515b251f:function(){return handleError(function(arg0){let ret=getObject(arg0).value;return addHeapObject(ret)},arguments)},__wbg_objectStoreNames_2fc72464aff4baed:function(arg0){let ret=getObject(arg0).objectStoreNames;return addHeapObject(ret)},__wbg_createObjectStore_cfb780710dbc3ad2:function(){return handleError(function(arg0,arg1,arg2,arg3){let ret=getObject(arg0).createObjectStore(getStringFromWasm0(arg1,arg2),getObject(arg3));return addHeapObject(ret)},arguments)},__wbg_deleteObjectStore_745da9b507613eca:function(){return handleError(function(arg0,arg1,arg2){getObject(arg0).deleteObjectStore(getStringFromWasm0(arg1,arg2))},arguments)},__wbg_transaction_66168ca19ab39a78:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).transaction(getObject(arg1),["readonly","readwrite","versionchange","readwriteflush","cleanup"][arg2]);return addHeapObject(ret)},arguments)},__wbg_instanceof_IdbFactory_9c1359c26643add1:function(arg0){let result;try{result=getObject(arg0)instanceof IDBFactory}catch{result=!1}return result},__wbg_open_a89af1720976a433:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).open(getStringFromWasm0(arg1,arg2));return addHeapObject(ret)},arguments)},__wbg_open_e8f45f3526088828:function(){return handleError(function(arg0,arg1,arg2,arg3){let ret=getObject(arg0).open(getStringFromWasm0(arg1,arg2),arg3>>>0);return addHeapObject(ret)},arguments)},__wbg_setmultientry_a4c0f50fb1bb8977:function(arg0,arg1){getObject(arg0).multiEntry=arg1!==0},__wbg_setunique_6f46c3f803001492:function(arg0,arg1){getObject(arg0).unique=arg1!==0},__wbg_bound_f24ae26594f11d12:function(){return handleError(function(arg0,arg1,arg2,arg3){let ret=IDBKeyRange.bound(getObject(arg0),getObject(arg1),arg2!==0,arg3!==0);return addHeapObject(ret)},arguments)},__wbg_indexNames_f6708f233630e491:function(arg0){let ret=getObject(arg0).indexNames;return addHeapObject(ret)},__wbg_add_534cfd1b901a15b4:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).add(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_add_4d2791d6295ba9ec:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).add(getObject(arg1),getObject(arg2));return addHeapObject(ret)},arguments)},__wbg_createIndex_6d4c3e20ee0f1066:function(){return handleError(function(arg0,arg1,arg2,arg3,arg4){let ret=getObject(arg0).createIndex(getStringFromWasm0(arg1,arg2),getObject(arg3),getObject(arg4));return addHeapObject(ret)},arguments)},__wbg_delete_34764ece57bdc720:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).delete(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_deleteIndex_86b1a90a771f3fd2:function(){return handleError(function(arg0,arg1,arg2){getObject(arg0).deleteIndex(getStringFromWasm0(arg1,arg2))},arguments)},__wbg_get_88b5e79e9daccb9f:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).get(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_openCursor_728ede41c2e2d7ec:function(){return handleError(function(arg0){let ret=getObject(arg0).openCursor();return addHeapObject(ret)},arguments)},__wbg_openCursor_8ca06744434102da:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).openCursor(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_openCursor_3193d7a663a8bc61:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).openCursor(getObject(arg1),["next","nextunique","prev","prevunique"][arg2]);return addHeapObject(ret)},arguments)},__wbg_put_b697dfdbcfb0598f:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).put(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_put_f83d95662936dee7:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).put(getObject(arg1),getObject(arg2));return addHeapObject(ret)},arguments)},__wbg_setautoincrement_56aa89e6d3e15210:function(arg0,arg1){getObject(arg0).autoIncrement=arg1!==0},__wbg_setkeypath_e6a7c50640d3005a:function(arg0,arg1){getObject(arg0).keyPath=getObject(arg1)},__wbg_setonupgradeneeded_8f3f0ac5d7130a6f:function(arg0,arg1){getObject(arg0).onupgradeneeded=getObject(arg1)},__wbg_result_fd2dae625828961d:function(){return handleError(function(arg0){let ret=getObject(arg0).result;return addHeapObject(ret)},arguments)},__wbg_error_1221bc1f1d0b14d3:function(){return handleError(function(arg0){let ret=getObject(arg0).error;return isLikeNone(ret)?0:addHeapObject(ret)},arguments)},__wbg_transaction_0549f2d854da77a6:function(arg0){let ret=getObject(arg0).transaction;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_setonsuccess_962c293b6e38a5d5:function(arg0,arg1){getObject(arg0).onsuccess=getObject(arg1)},__wbg_setonerror_bd61d0a61808ca40:function(arg0,arg1){getObject(arg0).onerror=getObject(arg1)},__wbg_setonabort_aedc77f0151af20c:function(arg0,arg1){getObject(arg0).onabort=getObject(arg1)},__wbg_setoncomplete_a9e0ec1d6568a6d9:function(arg0,arg1){getObject(arg0).oncomplete=getObject(arg1)},__wbg_setonerror_00500154a07e987d:function(arg0,arg1){getObject(arg0).onerror=getObject(arg1)},__wbg_abort_91c8863e70a93d96:function(){return handleError(function(arg0){getObject(arg0).abort()},arguments)},__wbg_objectStore_80724f9f6d33ab5b:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).objectStore(getStringFromWasm0(arg1,arg2));return addHeapObject(ret)},arguments)},__wbg_now_a69647afb1f66247:function(arg0){return getObject(arg0).now()},__wbg_byobRequest_b32c77640da946ac:function(arg0){let ret=getObject(arg0).byobRequest;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_close_aca7442e6619206b:function(){return handleError(function(arg0){getObject(arg0).close()},arguments)},__wbg_view_2a901bda0727aeb3:function(arg0){let ret=getObject(arg0).view;return isLikeNone(ret)?0:addHeapObject(ret)},__wbg_respond_a799bab31a44f2d7:function(){return handleError(function(arg0,arg1){getObject(arg0).respond(arg1>>>0)},arguments)},__wbg_close_cef2400b120c9c73:function(){return handleError(function(arg0){getObject(arg0).close()},arguments)},__wbg_enqueue_6f3d433b5e457aea:function(){return handleError(function(arg0,arg1){getObject(arg0).enqueue(getObject(arg1))},arguments)},__wbg_newwithstrandinit_a31c69e4cc337183:function(){return handleError(function(arg0,arg1,arg2){let ret=new Request(getStringFromWasm0(arg0,arg1),getObject(arg2));return addHeapObject(ret)},arguments)},__wbg_setbody_734cb3d7ee8e6e96:function(arg0,arg1){getObject(arg0).body=getObject(arg1)},__wbg_setcredentials_2b67800db3f7b621:function(arg0,arg1){getObject(arg0).credentials=["omit","same-origin","include"][arg1]},__wbg_setheaders_be10a5ab566fd06f:function(arg0,arg1){getObject(arg0).headers=getObject(arg1)},__wbg_setmethod_dc68a742c2db5c6a:function(arg0,arg1,arg2){getObject(arg0).method=getStringFromWasm0(arg1,arg2)},__wbg_setmode_a781aae2bd3df202:function(arg0,arg1){getObject(arg0).mode=["same-origin","no-cors","cors","navigate"][arg1]},__wbg_setsignal_91c4e8ebd04eb935:function(arg0,arg1){getObject(arg0).signal=getObject(arg1)},__wbg_instanceof_Response_e91b7eb7c611a9ae:function(arg0){let result;try{result=getObject(arg0)instanceof Response}catch{result=!1}return result},__wbg_url_1bf85c8abeb8c92d:function(arg0,arg1){let ret=getObject(arg1).url,ptr1=passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbg_status_ae8de515694c5c7c:function(arg0){return getObject(arg0).status},__wbg_headers_5e283e8345689121:function(arg0){let ret=getObject(arg0).headers;return addHeapObject(ret)},__wbg_arrayBuffer_a5fbad63cc7e663b:function(){return handleError(function(arg0){let ret=getObject(arg0).arrayBuffer();return addHeapObject(ret)},arguments)},__wbg_text_a94b91ea8700357a:function(){return handleError(function(arg0){let ret=getObject(arg0).text();return addHeapObject(ret)},arguments)},__wbg_fetch_ba7fe179e527d942:function(arg0,arg1){let ret=getObject(arg0).fetch(getObject(arg1));return addHeapObject(ret)},__wbg_now_28a6b413aca4a96a:function(){return handleError(function(){return Date.now()},arguments)},__wbg_crypto_1d1f22824a6a080c:function(arg0){let ret=getObject(arg0).crypto;return addHeapObject(ret)},__wbg_process_4a72847cc503995b:function(arg0){let ret=getObject(arg0).process;return addHeapObject(ret)},__wbg_versions_f686565e586dd935:function(arg0){let ret=getObject(arg0).versions;return addHeapObject(ret)},__wbg_node_104a2ff8d6ea03a2:function(arg0){let ret=getObject(arg0).node;return addHeapObject(ret)},__wbindgen_is_string:function(arg0){return typeof getObject(arg0)=="string"},__wbg_require_cca90b1a94a0255b:function(){return handleError(function(){let ret=module.require;return addHeapObject(ret)},arguments)},__wbg_msCrypto_eb05e62b530a1508:function(arg0){let ret=getObject(arg0).msCrypto;return addHeapObject(ret)},__wbg_randomFillSync_5c9c955aa56b6049:function(){return handleError(function(arg0,arg1){getObject(arg0).randomFillSync(takeObject(arg1))},arguments)},__wbg_getRandomValues_3aa56aa6edec874c:function(){return handleError(function(arg0,arg1){getObject(arg0).getRandomValues(getObject(arg1))},arguments)},__wbg_self_3093d5d1f7bcb682:function(){return handleError(function(){let ret=self.self;return addHeapObject(ret)},arguments)},__wbg_window_3bcfc4d31bc012f8:function(){return handleError(function(){let ret=window.window;return addHeapObject(ret)},arguments)},__wbg_globalThis_86b222e13bdf32ed:function(){return handleError(function(){let ret=globalThis.globalThis;return addHeapObject(ret)},arguments)},__wbg_global_e5a3fe56f8be9485:function(){return handleError(function(){let ret=global.global;return addHeapObject(ret)},arguments)},__wbg_newnoargs_76313bd6ff35d0f2:function(arg0,arg1){let ret=new Function(getStringFromWasm0(arg0,arg1));return addHeapObject(ret)},__wbg_length_ae22078168b726f5:function(arg0){return getObject(arg0).length},__wbg_new_a220cf903aa02ca2:function(){let ret=new Array;return addHeapObject(ret)},__wbg_next_de3e9db4440638b2:function(arg0){let ret=getObject(arg0).next;return addHeapObject(ret)},__wbg_value_6d39332ab4788d86:function(arg0){let ret=getObject(arg0).value;return addHeapObject(ret)},__wbg_iterator_888179a48810a9fe:function(){return addHeapObject(Symbol.iterator)},__wbg_new_525245e2b9901204:function(){let ret=new Object;return addHeapObject(ret)},__wbg_get_3baa728f9d58d3f6:function(arg0,arg1){let ret=getObject(arg0)[arg1>>>0];return addHeapObject(ret)},__wbg_isArray_8364a5371e9737d8:function(arg0){return Array.isArray(getObject(arg0))},__wbg_push_37c89022f34c01ca:function(arg0,arg1){return getObject(arg0).push(getObject(arg1))},__wbg_instanceof_ArrayBuffer_61dfc3198373c902:function(arg0){let result;try{result=getObject(arg0)instanceof ArrayBuffer}catch{result=!1}return result},__wbg_new_796382978dfd4fb0:function(arg0,arg1){let ret=new Error(getStringFromWasm0(arg0,arg1));return addHeapObject(ret)},__wbg_toString_9d18e102ca933e68:function(arg0){let ret=getObject(arg0).toString();return addHeapObject(ret)},__wbg_call_1084a111329e68ce:function(){return handleError(function(arg0,arg1){let ret=getObject(arg0).call(getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_call_89af060b4e1523f2:function(){return handleError(function(arg0,arg1,arg2){let ret=getObject(arg0).call(getObject(arg1),getObject(arg2));return addHeapObject(ret)},arguments)},__wbg_instanceof_Map_763ce0e95960d55e:function(arg0){let result;try{result=getObject(arg0)instanceof Map}catch{result=!1}return result},__wbg_next_f9cb570345655b9a:function(){return handleError(function(arg0){let ret=getObject(arg0).next();return addHeapObject(ret)},arguments)},__wbg_done_bfda7aa8f252b39f:function(arg0){return getObject(arg0).done},__wbg_isSafeInteger_7f1ed56200d90674:function(arg0){return Number.isSafeInteger(getObject(arg0))},__wbg_getTime_91058879093a1589:function(arg0){return getObject(arg0).getTime()},__wbg_getTimezoneOffset_c9929a3cc94500fe:function(arg0){return getObject(arg0).getTimezoneOffset()},__wbg_new_7982fb43cfca37ae:function(arg0){let ret=new Date(getObject(arg0));return addHeapObject(ret)},__wbg_new0_65387337a95cf44d:function(){return addHeapObject(new Date)},__wbg_now_b7a162010a9e75b4:function(){return Date.now()},__wbg_entries_7a0e06255456ebcd:function(arg0){let ret=Object.entries(getObject(arg0));return addHeapObject(ret)},__wbg_get_224d16597dbbfd96:function(){return handleError(function(arg0,arg1){let ret=Reflect.get(getObject(arg0),getObject(arg1));return addHeapObject(ret)},arguments)},__wbg_has_4bfbc01db38743f7:function(){return handleError(function(arg0,arg1){return Reflect.has(getObject(arg0),getObject(arg1))},arguments)},__wbg_buffer_b7b08af79b0b0974:function(arg0){let ret=getObject(arg0).buffer;return addHeapObject(ret)},__wbg_stringify_bbf45426c92a6bf5:function(){return handleError(function(arg0){let ret=JSON.stringify(getObject(arg0));return addHeapObject(ret)},arguments)},__wbg_new_b85e72ed1bfd57f9:function(arg0,arg1){try{var state0={a:arg0,b:arg1},cb0=(arg02,arg12)=>{let a=state0.a;state0.a=0;try{return __wbg_adapter_327(a,state0.b,arg02,arg12)}finally{state0.a=a}};let ret=new Promise(cb0);return addHeapObject(ret)}finally{state0.a=state0.b=0}},__wbg_resolve_570458cb99d56a43:function(arg0){let ret=Promise.resolve(getObject(arg0));return addHeapObject(ret)},__wbg_then_95e6edc0f89b73b1:function(arg0,arg1){let ret=getObject(arg0).then(getObject(arg1));return addHeapObject(ret)},__wbg_then_876bb3c633745cc6:function(arg0,arg1,arg2){let ret=getObject(arg0).then(getObject(arg1),getObject(arg2));return addHeapObject(ret)},__wbg_newwithbyteoffsetandlength_8a2cb9ca96b27ec9:function(arg0,arg1,arg2){let ret=new Uint8Array(getObject(arg0),arg1>>>0,arg2>>>0);return addHeapObject(ret)},__wbg_new_ea1883e1e5e86686:function(arg0){let ret=new Uint8Array(getObject(arg0));return addHeapObject(ret)},__wbg_instanceof_Uint8Array_247a91427532499e:function(arg0){let result;try{result=getObject(arg0)instanceof Uint8Array}catch{result=!1}return result},__wbg_newwithlength_ec548f448387c968:function(arg0){let ret=new Uint8Array(arg0>>>0);return addHeapObject(ret)},__wbg_buffer_0710d1b9dbe2eea6:function(arg0){let ret=getObject(arg0).buffer;return addHeapObject(ret)},__wbg_subarray_7c2e3576afe181d1:function(arg0,arg1,arg2){let ret=getObject(arg0).subarray(arg1>>>0,arg2>>>0);return addHeapObject(ret)},__wbg_length_8339fcf5d8ecd12e:function(arg0){return getObject(arg0).length},__wbg_byteLength_850664ef28f3e42f:function(arg0){return getObject(arg0).byteLength},__wbg_byteOffset_ea14c35fa6de38cc:function(arg0){return getObject(arg0).byteOffset},__wbg_set_d1e79e2388520f18:function(arg0,arg1,arg2){getObject(arg0).set(getObject(arg1),arg2>>>0)},__wbindgen_bigint_get_as_i64:function(arg0,arg1){let v=getObject(arg1),ret=typeof v=="bigint"?v:void 0;getDataViewMemory0().setBigInt64(arg0+8*1,isLikeNone(ret)?BigInt(0):ret,!0),getDataViewMemory0().setInt32(arg0+4*0,!isLikeNone(ret),!0)},__wbindgen_debug_string:function(arg0,arg1){let ret=debugString(getObject(arg1)),ptr1=passStringToWasm0(ret,wasm.__wbindgen_export_0,wasm.__wbindgen_export_1),len1=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(arg0+4*1,len1,!0),getDataViewMemory0().setInt32(arg0+4*0,ptr1,!0)},__wbindgen_throw:function(arg0,arg1){throw new Error(getStringFromWasm0(arg0,arg1))},__wbindgen_memory:function(){let ret=wasm.memory;return addHeapObject(ret)},__wbindgen_closure_wrapper22336:function(arg0,arg1,arg2){let ret=makeMutClosure(arg0,arg1,1804,__wbg_adapter_52);return addHeapObject(ret)},__wbindgen_closure_wrapper23721:function(arg0,arg1,arg2){let ret=makeMutClosure(arg0,arg1,1941,__wbg_adapter_55);return addHeapObject(ret)},__wbindgen_closure_wrapper28802:function(arg0,arg1,arg2){let ret=makeMutClosure(arg0,arg1,2511,__wbg_adapter_58);return addHeapObject(ret)}}},wasm_url=new URL("index_bg.wasm",import.meta.url),wasmCode="";switch(wasm_url.protocol){case"file:":wasmCode=await Deno.readFile(wasm_url);break;case"tauri:":case"https:":case"http:":wasmCode=await(await fetch(wasm_url)).arrayBuffer();break;default:throw new Error(`Unsupported protocol: ${wasm_url.protocol}`)}var wasmInstance=(await WebAssembly.instantiate(wasmCode,imports)).instance,wasm=wasmInstance.exports;import{getIncrementalID,ConnectionStatus,ConnectionUnavailable,AbstractEngine,UnexpectedConnectionError}from"surrealdb";function surrealdbWasmEngines(opts){class WasmEmbeddedEngine extends AbstractEngine{ready=void 0;reader;status=ConnectionStatus.Disconnected;queue=[];processing=!1;db;async version(){return SurrealWasmEngine.version()}setStatus(status,...args){this.status=status,this.emitter.emit(status,args)}async connect(url){this.connection.url=url,this.setStatus(ConnectionStatus.Connecting);let ready=(async()=>{let db=await SurrealWasmEngine.connect(url.toString(),opts).catch(e=>{console.log(e);let error=new UnexpectedConnectionError(typeof e=="string"?e:"error"in e?e.error:"An unexpected error occurred");throw this.setStatus(ConnectionStatus.Error,error),e});this.db=db,this.setStatus(ConnectionStatus.Connected),this.reader=(async()=>{let reader=db.notifications().getReader();for(;this.connected;){let{done,value}=await reader.read();if(done)break;let raw=value,{id,action,result}=this.decodeCbor(raw.buffer);id&&this.emitter.emit(`live-${id.toString()}`,[action,result],!0)}})()})();return this.ready=ready,await ready}async disconnect(){this.connection={url:void 0,namespace:void 0,database:void 0,token:void 0},await this.ready,this.ready=void 0,this.db?.free(),this.db=void 0,await this.reader,this.reader=void 0,this.status!==ConnectionStatus.Disconnected&&this.setStatus(ConnectionStatus.Disconnected)}async rpc(request){if(await this.ready,!this.db)throw new ConnectionUnavailable;return new Promise((resolve,reject)=>{this.queue.push(async()=>{try{let result=await this.execute(request);resolve(result)}catch(error){reject(error)}}),this.processQueue()})}get connected(){return!!this.db}async processQueue(){if(!this.processing){for(this.processing=!0;this.queue.length>0;){let task=this.queue.shift();if(task)try{await task()}catch(error){console.error("Query execution failed",error)}}this.processing=!1}}async execute(request){let id=getIncrementalID(),res=await this.db.execute(new Uint8Array(this.encodeCbor({id,...request}))).then(raw=>({result:this.decodeCbor(raw.buffer)})).catch(message=>({error:{code:-1,message}}));if("result"in res)switch(request.method){case"use":{this.connection.namespace=request.params?.[0],this.connection.database=request.params?.[1];break}case"signin":case"signup":{this.connection.token=res.result;break}case"authenticate":{this.connection.token=request.params?.[0];break}case"invalidate":{this.connection.token=void 0;break}}return res}}return{mem:WasmEmbeddedEngine,indxdb:WasmEmbeddedEngine}}export{surrealdbWasmEngines};
